(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{JGKh:function(e,t,n){"use strict";n.r(t),n.d(t,"StudentChatPageModule",function(){return M});var s=n("ofXK"),i=n("3Pt+"),o=n("TEn/"),a=n("tyNb"),r=n("mrSG"),c=n("gLVQ"),b=n("Y19J"),l=n("Aso2"),u=n("7xvl"),d=n("fXoL");function g(e,t){1&e&&(d.Mb(0,"div",9),d.Mb(1,"p"),d.lc(2,"You have "),d.Mb(3,"b"),d.lc(4,"no messages"),d.Lb(),d.lc(5," in your inbox. Please press the "),d.Ib(6,"ion-icon",10),d.lc(7," button to create a new message. "),d.Lb(),d.Lb())}function p(e,t){if(1&e){const e=d.Nb();d.Mb(0,"ion-item-sliding",4),d.Ub("click",function(){d.fc(e);const n=t.$implicit;return d.Wb().chatPage(n.chatId)}),d.Mb(1,"ion-item",11),d.Mb(2,"ion-avatar",1),d.Ib(3,"img",12),d.Lb(),d.Mb(4,"ion-label"),d.Mb(5,"h2"),d.lc(6),d.Mb(7,"span",13),d.lc(8),d.Lb(),d.Lb(),d.Mb(9,"p"),d.lc(10),d.Lb(),d.Lb(),d.Lb(),d.Ib(11,"ion-item-options",14),d.Lb()}if(2&e){const e=t.$implicit;d.xb(3),d.ac("src",e.isUser?e.respondingUserPhoto:e.requestingUserPhoto,d.hc),d.xb(3),d.nc("",e.isUser?e.respondingUserFullname:e.requestingUserFullname," "),d.xb(2),d.nc("\xb7 ",e.lastMessageTime,""),d.xb(2),d.mc(e.lastMessageText)}}const h=[{path:"",component:(()=>{class e{constructor(e,t,n,s){this.router=e,this.modal=t,this.studentChat=n,this.profile=s}ngOnInit(){this.profile.getUserDetails().subscribe(e=>{this.fullName=e.fullName,this.profilePicture=e.profilePicture,this.email=e.email,this.studentChat.conversations$.subscribe(e=>{this.conversations=Object.values(e).reverse();for(let t of this.conversations){for(const e of t.messages)e.date=Object(u.a)(new Date(e.date));t.requestingUserEmail===this.email&&(t.isUser=!0),t.lastMessage=t.messages.slice(-1)[0],t.lastMessageText=t.lastMessage.text,t.lastMessageTime=t.lastMessage.date}})})}chatPage(e){this.router.navigate(["home/posts/student-chat/chat-page",e,this.fullName,this.profilePicture,this.email])}newMessage(){return Object(r.a)(this,void 0,void 0,function*(){const e=yield this.modal.create({component:c.a,componentProps:{}});yield e.present()})}delete(e){}}return e.\u0275fac=function(t){return new(t||e)(d.Hb(a.f),d.Hb(o.T),d.Hb(b.a),d.Hb(l.a))},e.\u0275cmp=d.Bb({type:e,selectors:[["app-student-chat"]],decls:15,vars:2,consts:[[1,"ion-hide-lg-up"],["slot","start"],[1,"toolbar-title"],["slot","end"],[3,"click"],["size","large","name","create",1,"new-message"],[1,"searchbar-wrapper","ion-hide-lg-up"],["id","no-messages","class","ion-text-center","style","margin-top: 75px; padding: 15px;",4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],["id","no-messages",1,"ion-text-center",2,"margin-top","75px","padding","15px"],["size","small","name","create",1,"new-message"],[1,"unread"],[3,"src"],[1,"date-sent"],["side","end"]],template:function(e,t){1&e&&(d.Mb(0,"ion-header",0),d.Mb(1,"ion-toolbar"),d.Mb(2,"ion-buttons",1),d.Ib(3,"ion-back-button"),d.Mb(4,"p",2),d.lc(5,"Student Chat"),d.Lb(),d.Lb(),d.Mb(6,"ion-buttons",3),d.Mb(7,"ion-button",4),d.Ub("click",function(){return t.newMessage()}),d.Ib(8,"ion-icon",5),d.Lb(),d.Lb(),d.Lb(),d.Lb(),d.Mb(9,"ion-content"),d.Mb(10,"ion-toolbar",6),d.Ib(11,"ion-searchbar"),d.Lb(),d.Mb(12,"ion-list",0),d.kc(13,g,8,0,"div",7),d.kc(14,p,12,4,"ion-item-sliding",8),d.Lb(),d.Lb()),2&e&&(d.xb(13),d.Zb("ngIf",0==t.conversations),d.xb(1),d.Zb("ngForOf",t.conversations))},directives:[o.u,o.P,o.h,o.e,o.f,o.g,o.v,o.o,o.H,o.Y,o.C,s.i,s.h,o.A,o.x,o.d,o.B,o.z],styles:[".new-message[_ngcontent-%COMP%]{color:#faa71b}ion-label[_ngcontent-%COMP%]{font-weight:800;display:block}.searchbar-wrapper[_ngcontent-%COMP%]{margin:20px 0}.unread[_ngcontent-%COMP%]{--background:#cbd7e6}.date-sent[_ngcontent-%COMP%]{font-size:.8em;opacity:.5}"]}),e})()},{path:"chat-page/:chatId/:fullName/:profilePicture/:email",loadChildren:()=>Promise.all([n.e(0),n.e(50)]).then(n.bind(null,"j1T8")).then(e=>e.ChatPagePageModule)}];let m=(()=>{class e{}return e.\u0275mod=d.Fb({type:e}),e.\u0275inj=d.Eb({factory:function(t){return new(t||e)},imports:[[a.j.forChild(h)],a.j]}),e})();var f=n("AhZb");let M=(()=>{class e{}return e.\u0275mod=d.Fb({type:e}),e.\u0275inj=d.Eb({factory:function(t){return new(t||e)},imports:[[s.b,i.d,o.Q,m,f.NewMessageStudentPageModule]]}),e})()}}]);