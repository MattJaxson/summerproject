!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{"aGP+":function(n,o,r){"use strict";r.r(o),r.d(o,"ChangeProfilePicturePageModule",function(){return C});var i=r("ofXK"),a=r("3Pt+"),s=r("TEn/"),c=r("tyNb"),u=r("mrSG"),p=r("Aso2"),d=r("6/gD"),l=r("AytR"),b=r("1tJ+"),g=r("DtjX"),h=r("wbj2"),f=r("fXoL");function m(e,t){if(1&e&&f.Ib(0,"img",15),2&e){var n=f.Wb();f.ac("src",n.imageUrl,f.ic)}}function x(e,t){if(1&e&&f.Ib(0,"img",15),2&e){var n=f.Wb();f.ac("src",n.uploadedPhotoURL,f.ic)}}var w,P,k,v=[{path:"",component:(w=function(){function n(t,o,r,i,a,s,c,u,p){e(this,n),this.photo=t,this.router=o,this.profile=r,this.alert=i,this.modal=a,this.toast=s,this.loading=c,this.postEmitter=u,this.singlePostEmitterService=p,this.imageUrl=this.profile.profilePicture.getValue(),this.uploadedPhoto=!1,this.awsPrefix=this.imageUrl.slice(-51),this.BACKEND_URL=l.a.url}var o,r,i;return o=n,(r=[{key:"ngOnInit",value:function(){var e=this;this.profile.getUserDetails().subscribe(function(t){e.userEmail=t.email,console.log(e.userEmail)})}},{key:"getFormData",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,o,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=document.querySelectorAll("form"),t.next=3,n.forEach(function(e){"changePhotoForm"===e.id&&(console.log("Got Form: "+e),r.formData=new FormData(e),r.uploadedPhoto=!0)});case 3:return console.log(this.formData),o=new FileReader,t.next=7,o.addEventListener("load",function(){return Object(u.a)(r,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.uploadedPhotoURL=o.result,console.log("Before cropping: "+o.result),e.next=4,this.cropPhoto(this.uploadedPhotoURL);case 4:case"end":return e.stop()}},e,this)}))},!0);case 7:if(!n){t.next=9;break}return t.abrupt("return",o.readAsDataURL(e.target.files[0]));case 9:case"end":return t.stop()}},t,this)}))}},{key:"uploadChangedPhoto",value:function(){var e=this,t=new FormData;t.append("oldPhotoKey",this.awsPrefix),t.append("email",this.userEmail);var n=new File([this.dataURLtoBlob(this.uploadedPhotoURL)],"picture.png");t.append("profile-picture-update",n),!0===this.uploadedPhoto&&this.photo.changeProfilePicture(t).subscribe(function(t){console.log(t);var n=t.objectUrl;e.presentLoading(),e.profile.profilePicture.next(n),e.presentToast(),e.postEmitter.postPageRefresh(),e.singlePostEmitterService.singlePostPageRefresh(),e.router.navigate(["/home/profile"])})}},{key:"presentToast",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.toast.create({message:"Your Profile Picture has been changed",animated:!0,cssClass:"updated-toast",duration:2e3});case 2:e.sent.present();case 3:case"end":return e.stop()}},e,this)}))}},{key:"presentLoading",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loading.create({cssClass:"my-custom-class",message:"Updating Photo...",duration:1e3});case 2:return t=e.sent,e.next=5,t.present();case 5:return e.next=7,t.onDidDismiss();case 7:console.log("Loading dismissed!");case 8:case"end":return e.stop()}},e,this)}))}},{key:"cropPhoto",value:function(e){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,o=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.modal.create({component:b.a,cssClass:"image-cropper",componentProps:{uploadedPhotoURL:e}});case 2:return n=t.sent,t.next=5,n.present();case 5:n.onDidDismiss().then(function(e){o.uploadedPhotoURL=e.data});case 6:case"end":return t.stop()}},t,this)}))}},{key:"dataURLtoBlob",value:function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],o=atob(t[1]),r=o.length,i=new Uint8Array(r);r--;)i[r]=o.charCodeAt(r);return new Blob([i],{type:n})}},{key:"goBack",value:function(){this.router.navigate(["/home/profile"])}}])&&t(o.prototype,r),i&&t(o,i),n}(),w.\u0275fac=function(e){return new(e||w)(f.Hb(d.a),f.Hb(c.f),f.Hb(p.a),f.Hb(s.a),f.Hb(s.W),f.Hb(s.eb),f.Hb(s.V),f.Hb(g.a),f.Hb(h.a))},w.\u0275cmp=f.Bb({type:w,selectors:[["app-change-profile-picture"]],decls:30,vars:3,consts:[[1,"ion-hide-lg-up"],["slot","start"],[1,"ion-text-center"],[1,"ion-hide-lg-down","ion-justify-content-center",2,"padding-top","80px","margin-bottom","40px"],["size-xs","11","size-sm","10","size-md","10","size-lg","8","size-xl","6"],[1,"desktop-toolbar"],["slot","end"],[1,"back-button",3,"click"],[1,"ion-justify-content-center"],["size-xs","11","size-sm","10","size-md","8","size-lg","6","size-xl","4",2,"margin-top","50px"],[1,"text-header"],["id","profile-picture","alt","Profile Picture",3,"src",4,"ngIf"],["id","changePhotoForm",3,"ngSubmit"],["name","profile-picture-update","placeholder","Upload Image","type","file",3,"change"],["type","submit",1,"orange-button",3,"disabled"],["id","profile-picture","alt","Profile Picture",3,"src"]],template:function(e,t){1&e&&(f.Mb(0,"ion-header",0),f.Mb(1,"ion-toolbar"),f.Mb(2,"ion-buttons",1),f.Ib(3,"ion-back-button"),f.Lb(),f.Mb(4,"ion-title"),f.nc(5,"Change Profile Picture"),f.Lb(),f.Lb(),f.Lb(),f.Mb(6,"ion-content",2),f.Mb(7,"ion-grid"),f.Mb(8,"ion-row",3),f.Mb(9,"ion-col",4),f.Mb(10,"ion-toolbar",5),f.Mb(11,"ion-buttons",1),f.Mb(12,"h1"),f.nc(13,"Change Profile Picture"),f.Lb(),f.Lb(),f.Mb(14,"ion-buttons",6),f.Mb(15,"ion-button",7),f.Ub("click",function(){return t.goBack()}),f.nc(16," Back "),f.Lb(),f.Lb(),f.Lb(),f.Lb(),f.Lb(),f.Mb(17,"ion-row",8),f.Mb(18,"ion-col",9),f.Mb(19,"h6",10),f.nc(20,"Please select the profile picture you will use to replace your current one. Only pictures with the extentions "),f.Mb(21,"span"),f.nc(22,"'.png', '.jpg', and '.jpeg'"),f.Lb(),f.nc(23," are allowed. "),f.Lb(),f.mc(24,m,1,1,"img",11),f.mc(25,x,1,1,"img",11),f.Mb(26,"form",12),f.Ub("ngSubmit",function(){return t.uploadChangedPhoto()}),f.Mb(27,"input",13),f.Ub("change",function(e){return t.getFormData(e)}),f.Lb(),f.Mb(28,"ion-button",14),f.nc(29,"Update "),f.Lb(),f.Lb(),f.Lb(),f.Lb(),f.Lb(),f.Lb()),2&e&&(f.xb(24),f.Zb("ngIf",!t.uploadedPhoto),f.xb(1),f.Zb("ngIf",t.uploadedPhoto),f.xb(3),f.Zb("disabled",!t.imageUrl))},directives:[s.u,s.S,s.h,s.e,s.f,s.R,s.o,s.t,s.I,s.n,s.g,i.j,a.o,a.j,a.k],styles:[".desktop-toolbar[_ngcontent-%COMP%]{--background:none;padding-bottom:16px;border-bottom:1px solid rgba(51,51,51,.14901960784313725)}.desktop-toolbar[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#0055a5}.text-header[_ngcontent-%COMP%]{background:#e4ebf1}.back-button[_ngcontent-%COMP%]{--color:#fff;--background:#0055a5;--background-hover:linear-gradient(#0055a5,#0d2e4d);height:24px;--border-radius:5px;width:100px;font-size:.5em;font-weight:600;display:block}#profile-picture[_ngcontent-%COMP%]{height:100px;width:100px;border-radius:100px;margin:50px auto;display:block;opacity:0;border:2px solid #005191;-webkit-animation:pic-slide-right .5s cubic-bezier(.175,.885,.32,1.275) .5s forwards;animation:pic-slide-right .5s cubic-bezier(.175,.885,.32,1.275) .5s forwards}.orange-button[_ngcontent-%COMP%]{width:unset;display:block;margin:40px auto;width:200px}.blue-button[_ngcontent-%COMP%]{width:200px}.skip-button[_ngcontent-%COMP%]{display:block;--background:none;color:#888;--border-color:#888;--border-width:3px;--border-style:solid;width:200px;margin:40px auto;opacity:.5}.blue-button[_ngcontent-%COMP%], .skip-button[_ngcontent-%COMP%]{-webkit-animation:none;animation:none}.blue-button[_ngcontent-%COMP%]{width:unset;opacity:unset}.wrapper[_ngcontent-%COMP%]{box-shadow:1px 1px 10px rgba(0,0,0,.1);height:auto;padding:50px}#default-picture-wrapper[_ngcontent-%COMP%]{height:100px;width:100px;margin:20px auto 50px;border-radius:50px;background-image:url(default-pro-picture.5289221102b9ba5395fe.svg);opacity:0;-webkit-animation:slide-up .5s cubic-bezier(.175,.885,.32,1) .5s forwards;animation:slide-up .5s cubic-bezier(.175,.885,.32,1) .5s forwards}#upload-picture-wrapper[_ngcontent-%COMP%]{height:100px;width:100px;border:4px solid #005191;margin:0 auto 50px;border-radius:50px;-webkit-animation:slide-up .5s cubic-bezier(.175,.885,.32,1.275) .5s forwards;animation:slide-up .5s cubic-bezier(.175,.885,.32,1.275) .5s forwards}span[_ngcontent-%COMP%]{color:#ffb351;font-weight:600;background:#222;padding:6px;line-height:1.5em;border-radius:5px}#next-button[_ngcontent-%COMP%]{width:100%;height:60px;background:#d3d3d3;position:absolute;bottom:0;font-size:1em}.text-header[_ngcontent-%COMP%]{font-size:1.2em;padding:unset;color:#333}.cancel-button[_ngcontent-%COMP%]{color:#e4405f;--background:none;--background-hover:none;height:50px;width:200px;box-shadow:1px 1px 10px rgba(0,0,0,.1);transition:.5s;transition-timing-function:cubic-bezier(.175,.885,.32,1.275)}.cancel-button[_ngcontent-%COMP%]:hover{box-shadow:1px 1px 10px rgba(0,0,0,.4)}.camera-button[_ngcontent-%COMP%]{--background:#fff;--color:#005191;--border-style:solid;--border-width:1px;--border-color:#005191;border:1px;margin:30px auto}input[type=file][_ngcontent-%COMP%]{color:#fff;font-size:1.2em;font-weight:600;border:1px solid #005191;background:linear-gradient(#0672c4,#005191);width:400px;height:50px;border-radius:5px;padding:20px 0 0 20px;text-align:center;cursor:pointer}input[type=file][_ngcontent-%COMP%]::-webkit-file-upload-button{visibility:hidden}#img-wrapper[_ngcontent-%COMP%]{height:150px;width:150px;margin:50px auto}@-webkit-keyframes lide-up{0%{transform:translateY(100px)}to{transform:translateY(0);opacity:1}}@keyframes lide-up{0%{transform:translateY(100px)}to{transform:translateY(0);opacity:1}}"]}),w)},{path:"confirm",loadChildren:function(){return r.e(59).then(r.bind(null,"TY5D")).then(function(e){return e.ConfirmPageModule})}}],y=((P=function t(){e(this,t)}).\u0275mod=f.Fb({type:P}),P.\u0275inj=f.Eb({factory:function(e){return new(e||P)},imports:[[c.j.forChild(v)],c.j]}),P),M=r("Scpy"),C=((k=function t(){e(this,t)}).\u0275mod=f.Fb({type:k}),k.\u0275inj=f.Eb({factory:function(e){return new(e||k)},imports:[[i.b,a.d,s.T,y,M.ImageCropperPageModule]]}),k)}}])}();