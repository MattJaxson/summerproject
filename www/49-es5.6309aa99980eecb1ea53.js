!function(){function e(e,n){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,n)}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,i=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw i}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{JGKh:function(t,o,a){"use strict";a.r(o),a.d(o,"StudentChatPageModule",function(){return L});var i=a("ofXK"),s=a("3Pt+"),c=a("TEn/"),u=a("tyNb"),l=a("mrSG"),b=a("gLVQ"),f=a("Y19J"),m=a("Aso2"),p=a("7xvl"),g=a("fXoL");function d(e,t){1&e&&(g.Mb(0,"div",9),g.Mb(1,"p"),g.mc(2,"You have "),g.Mb(3,"b"),g.mc(4,"no messages"),g.Lb(),g.mc(5," in your inbox. Please press the "),g.Ib(6,"ion-icon",10),g.mc(7," button to create a new message. "),g.Lb(),g.Lb())}function h(e,t){if(1&e){var n=g.Nb();g.Mb(0,"ion-item-sliding",4),g.Ub("click",function(){g.gc(n);var e=t.$implicit;return g.Wb().chatPage(e.chatId)}),g.Mb(1,"ion-item",11),g.Mb(2,"ion-avatar",1),g.Ib(3,"img",12),g.Lb(),g.Mb(4,"ion-label"),g.Mb(5,"h2"),g.mc(6),g.Mb(7,"span",13),g.mc(8),g.Lb(),g.Lb(),g.Mb(9,"p"),g.mc(10),g.Lb(),g.Lb(),g.Lb(),g.Ib(11,"ion-item-options",14),g.Lb()}if(2&e){var r=t.$implicit;g.xb(3),g.ac("src",r.isUser?r.respondingUserPhoto:r.requestingUserPhoto,g.ic),g.xb(3),g.oc("",r.isUser?r.respondingUserFullname:r.requestingUserFullname," "),g.xb(2),g.oc("\xb7 ",r.lastMessageTime,""),g.xb(2),g.nc(r.lastMessageText)}}var v,y,M,w=[{path:"",component:(v=function(){function t(e,r,o,a){n(this,t),this.router=e,this.modal=r,this.studentChat=o,this.profile=a}var o,a,i;return o=t,(a=[{key:"ngOnInit",value:function(){var t=this;this.profile.getUserDetails().subscribe(function(n){t.fullName=n.fullName,t.profilePicture=n.profilePicture,t.email=n.email,t.studentChat.conversations$.subscribe(function(n){t.conversations=Object.values(n).reverse();var r,o=e(t.conversations);try{for(o.s();!(r=o.n()).done;){var a,i=r.value,s=e(i.messages);try{for(s.s();!(a=s.n()).done;){var c=a.value;c.date=Object(p.a)(new Date(c.date))}}catch(u){s.e(u)}finally{s.f()}i.requestingUserEmail===t.email&&(i.isUser=!0),i.lastMessage=i.messages.slice(-1)[0],i.lastMessageText=i.lastMessage.text,i.lastMessageTime=i.lastMessage.date}}catch(u){o.e(u)}finally{o.f()}})})}},{key:"chatPage",value:function(e){this.router.navigate(["home/posts/student-chat/chat-page",e,this.fullName,this.profilePicture,this.email])}},{key:"newMessage",value:function(){return Object(l.a)(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modal.create({component:b.a,componentProps:{}});case 2:return t=e.sent,e.next=5,t.present();case 5:case"end":return e.stop()}},e,this)}))}},{key:"delete",value:function(e){}}])&&r(o.prototype,a),i&&r(o,i),t}(),v.\u0275fac=function(e){return new(e||v)(g.Hb(u.f),g.Hb(c.T),g.Hb(f.a),g.Hb(m.a))},v.\u0275cmp=g.Bb({type:v,selectors:[["app-student-chat"]],decls:15,vars:2,consts:[[1,"ion-hide-lg-up"],["slot","start"],[1,"toolbar-title"],["slot","end"],[3,"click"],["size","large","name","create",1,"new-message"],[1,"searchbar-wrapper","ion-hide-lg-up"],["id","no-messages","class","ion-text-center","style","margin-top: 75px; padding: 15px;",4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],["id","no-messages",1,"ion-text-center",2,"margin-top","75px","padding","15px"],["size","small","name","create",1,"new-message"],[1,"unread"],[3,"src"],[1,"date-sent"],["side","end"]],template:function(e,t){1&e&&(g.Mb(0,"ion-header",0),g.Mb(1,"ion-toolbar"),g.Mb(2,"ion-buttons",1),g.Ib(3,"ion-back-button"),g.Mb(4,"p",2),g.mc(5,"Student Chat"),g.Lb(),g.Lb(),g.Mb(6,"ion-buttons",3),g.Mb(7,"ion-button",4),g.Ub("click",function(){return t.newMessage()}),g.Ib(8,"ion-icon",5),g.Lb(),g.Lb(),g.Lb(),g.Lb(),g.Mb(9,"ion-content"),g.Mb(10,"ion-toolbar",6),g.Ib(11,"ion-searchbar"),g.Lb(),g.Mb(12,"ion-list",0),g.lc(13,d,8,0,"div",7),g.lc(14,h,12,4,"ion-item-sliding",8),g.Lb(),g.Lb()),2&e&&(g.xb(13),g.Zb("ngIf",0==t.conversations),g.xb(1),g.Zb("ngForOf",t.conversations))},directives:[c.t,c.P,c.h,c.e,c.f,c.g,c.u,c.o,c.G,c.Y,c.B,i.j,i.i,c.z,c.w,c.d,c.A,c.y],styles:[".new-message[_ngcontent-%COMP%]{color:#faa71b}ion-label[_ngcontent-%COMP%]{font-weight:800;display:block}.searchbar-wrapper[_ngcontent-%COMP%]{margin:20px 0}.unread[_ngcontent-%COMP%]{--background:#cbd7e6}.date-sent[_ngcontent-%COMP%]{font-size:.8em;opacity:.5}"]}),v)},{path:"chat-page/:chatId/:fullName/:profilePicture/:email",loadChildren:function(){return Promise.all([a.e(0),a.e(48)]).then(a.bind(null,"j1T8")).then(function(e){return e.ChatPagePageModule})}}],P=((y=function e(){n(this,e)}).\u0275mod=g.Fb({type:y}),y.\u0275inj=g.Eb({factory:function(e){return new(e||y)},imports:[[u.j.forChild(w)],u.j]}),y),x=a("AhZb"),L=((M=function e(){n(this,e)}).\u0275mod=g.Fb({type:M}),M.\u0275inj=g.Eb({factory:function(e){return new(e||M)},imports:[[i.b,s.d,c.Q,P,x.NewMessageStudentPageModule]]}),M)}}])}();